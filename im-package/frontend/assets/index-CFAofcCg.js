var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{r as s,b as a,a as r}from"./vendor-DTGuUW4E.js";import{B as i,R as n,a as l,N as o}from"./router-BPgAGOg9.js";import{a as c,c as d,l as u}from"./utils-DkG88q3V.js";import{W as m,a as x,C as h,X as p,b as g,U as f,M as y,S as b,F as v,D as j,E as w,I as N,P as k,c as C,d as S,e as _,V as E,f as O,g as M,h as z,i as P,j as $,k as A,l as L,B as F,m as I,L as D,n as T,o as R}from"./ui-DFMr0BJ7.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var U={exports:{}},q={},G=s,H=Symbol.for("react.element"),B=Symbol.for("react.fragment"),J=Object.prototype.hasOwnProperty,K=G.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Q={key:!0,ref:!0,__self:!0,__source:!0};function W(e,t,s){var a,r={},i=null,n=null;for(a in void 0!==s&&(i=""+s),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(n=t.ref),t)J.call(t,a)&&!Q.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:H,type:e,key:i,ref:n,props:r,_owner:K.current}}q.Fragment=B,q.jsx=W,q.jsxs=W,U.exports=q;var V=U.exports,Y={},Z=a;Y.createRoot=Z.createRoot,Y.hydrateRoot=Z.hydrateRoot;let X,ee,te,se={data:""},ae=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,re=/\/\*[^]*?\*\/|  +/g,ie=/\n+/g,ne=(e,t)=>{let s="",a="",r="";for(let i in e){let n=e[i];"@"==i[0]?"i"==i[1]?s=i+" "+n+";":a+="f"==i[1]?ne(n,i):i+"{"+ne(n,"k"==i[1]?"":t)+"}":"object"==typeof n?a+=ne(n,t?t.replace(/([^,])+/g,e=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):i):null!=n&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),r+=ne.p?ne.p(i,n):i+":"+n+";")}return s+(t&&r?t+"{"+r+"}":r)+a},le={},oe=e=>{if("object"==typeof e){let t="";for(let s in e)t+=s+oe(e[s]);return t}return e};function ce(e){let t=this||{},s=e.call?e(t.p):e;return((e,t,s,a,r)=>{let i=oe(e),n=le[i]||(le[i]=(e=>{let t=0,s=11;for(;t<e.length;)s=101*s+e.charCodeAt(t++)>>>0;return"go"+s})(i));if(!le[n]){let t=i!==e?e:(e=>{let t,s,a=[{}];for(;t=ae.exec(e.replace(re,""));)t[4]?a.shift():t[3]?(s=t[3].replace(ie," ").trim(),a.unshift(a[0][s]=a[0][s]||{})):a[0][t[1]]=t[2].replace(ie," ").trim();return a[0]})(e);le[n]=ne(r?{["@keyframes "+n]:t}:t,s?"":"."+n)}let l=s&&le.g?le.g:null;return s&&(le.g=le[n]),o=le[n],c=t,d=a,(u=l)?c.data=c.data.replace(u,o):-1===c.data.indexOf(o)&&(c.data=d?o+c.data:c.data+o),n;var o,c,d,u})(s.unshift?s.raw?((e,t,s)=>e.reduce((e,a,r)=>{let i=t[r];if(i&&i.call){let e=i(s),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;i=t?"."+t:e&&"object"==typeof e?e.props?"":ne(e,""):!1===e?"":e}return e+a+(null==i?"":i)},""))(s,[].slice.call(arguments,1),t.p):s.reduce((e,s)=>Object.assign(e,s&&s.call?s(t.p):s),{}):s,(e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||se})(t.target),t.g,t.o,t.k)}ce.bind({g:1});let de=ce.bind({k:1});function ue(e,t){let s=this||{};return function(){let t=arguments;return function a(r,i){let n=Object.assign({},r),l=n.className||a.className;s.p=Object.assign({theme:ee&&ee()},n),s.o=/ *go\d+/.test(l),n.className=ce.apply(s,t)+(l?" "+l:"");let o=e;return e[0]&&(o=n.as||e,delete n.as),te&&o[0]&&te(n),X(o,n)}}}var me=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,xe=(()=>{let e=0;return()=>(++e).toString()})(),he=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),pe="default",ge=(e,t)=>{let{toastLimit:s}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,s)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:a}=t;return ge(e,{type:e.toasts.find(e=>e.id===a.id)?1:0,toast:a});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+i}))}}},fe=[],ye={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},be={},ve=(e,t=pe)=>{be[t]=ge(be[t]||ye,e),fe.forEach(([e,s])=>{e===t&&s(be[t])})},je=e=>Object.keys(be).forEach(t=>ve(e,t)),we=(e=pe)=>t=>{ve(t,e)},Ne={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},ke=e=>(t,s)=>{let a=((e,t="blank",s)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...s,id:(null==s?void 0:s.id)||xe()}))(t,e,s);return we(a.toasterId||(e=>Object.keys(be).find(t=>be[t].toasts.some(t=>t.id===e)))(a.id))({type:2,toast:a}),a.id},Ce=(e,t)=>ke("blank")(e,t);Ce.error=ke("error"),Ce.success=ke("success"),Ce.loading=ke("loading"),Ce.custom=ke("custom"),Ce.dismiss=(e,t)=>{let s={type:3,toastId:e};t?we(t)(s):je(s)},Ce.dismissAll=e=>Ce.dismiss(void 0,e),Ce.remove=(e,t)=>{let s={type:4,toastId:e};t?we(t)(s):je(s)},Ce.removeAll=e=>Ce.remove(void 0,e),Ce.promise=(e,t,s)=>{let a=Ce.loading(t.loading,{...s,...null==s?void 0:s.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let r=t.success?me(t.success,e):void 0;return r?Ce.success(r,{id:a,...s,...null==s?void 0:s.success}):Ce.dismiss(a),e}).catch(e=>{let r=t.error?me(t.error,e):void 0;r?Ce.error(r,{id:a,...s,...null==s?void 0:s.error}):Ce.dismiss(a)}),e};var Se,_e,Ee,Oe,Me=(e,t="default")=>{let{toasts:a,pausedAt:r}=((e={},t=pe)=>{let[a,r]=s.useState(be[t]||ye),i=s.useRef(be[t]);s.useEffect(()=>(i.current!==be[t]&&r(be[t]),fe.push([t,r]),()=>{let e=fe.findIndex(([e])=>e===t);e>-1&&fe.splice(e,1)}),[t]);let n=a.toasts.map(t=>{var s,a,r;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(s=e[t.type])?void 0:s.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(a=e[t.type])?void 0:a.duration)||(null==e?void 0:e.duration)||Ne[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}});return{...a,toasts:n}})(e,t),i=s.useRef(new Map).current,n=s.useCallback((e,t=1e3)=>{if(i.has(e))return;let s=setTimeout(()=>{i.delete(e),l({type:4,toastId:e})},t);i.set(e,s)},[]);s.useEffect(()=>{if(r)return;let e=Date.now(),s=a.map(s=>{if(s.duration===1/0)return;let a=(s.duration||0)+s.pauseDuration-(e-s.createdAt);if(!(a<0))return setTimeout(()=>Ce.dismiss(s.id,t),a);s.visible&&Ce.dismiss(s.id)});return()=>{s.forEach(e=>e&&clearTimeout(e))}},[a,r,t]);let l=s.useCallback(we(t),[t]),o=s.useCallback(()=>{l({type:5,time:Date.now()})},[l]),c=s.useCallback((e,t)=>{l({type:1,toast:{id:e,height:t}})},[l]),d=s.useCallback(()=>{r&&l({type:6,time:Date.now()})},[r,l]),u=s.useCallback((e,t)=>{let{reverseOrder:s=!1,gutter:r=8,defaultPosition:i}=t||{},n=a.filter(t=>(t.position||i)===(e.position||i)&&t.height),l=n.findIndex(t=>t.id===e.id),o=n.filter((e,t)=>t<l&&e.visible).length;return n.filter(e=>e.visible).slice(...s?[o+1]:[0,o]).reduce((e,t)=>e+(t.height||0)+r,0)},[a]);return s.useEffect(()=>{a.forEach(e=>{if(e.dismissed)n(e.id,e.removeDelay);else{let t=i.get(e.id);t&&(clearTimeout(t),i.delete(e.id))}})},[a,n]),{toasts:a,handlers:{updateHeight:c,startPause:o,endPause:d,calculateOffset:u}}},ze=de`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Pe=de`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,$e=de`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,Ae=ue("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${ze} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Pe} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${$e} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Le=de`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,Fe=ue("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Le} 1s linear infinite;
`,Ie=de`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,De=de`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Te=ue("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Ie} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${De} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Re=ue("div")`
  position: absolute;
`,Ue=ue("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,qe=de`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ge=ue("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${qe} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,He=({toast:e})=>{let{icon:t,type:a,iconTheme:r}=e;return void 0!==t?"string"==typeof t?s.createElement(Ge,null,t):t:"blank"===a?null:s.createElement(Ue,null,s.createElement(Fe,{...r}),"loading"!==a&&s.createElement(Re,null,"error"===a?s.createElement(Ae,{...r}):s.createElement(Te,{...r})))},Be=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,Je=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,Ke=ue("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,Qe=ue("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,We=s.memo(({toast:e,position:t,style:a,children:r})=>{let i=e.height?((e,t)=>{let s=e.includes("top")?1:-1,[a,r]=he()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[Be(s),Je(s)];return{animation:t?`${de(a)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${de(r)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(e.position||t||"top-center",e.visible):{opacity:0},n=s.createElement(He,{toast:e}),l=s.createElement(Qe,{...e.ariaProps},me(e.message,e));return s.createElement(Ke,{className:e.className,style:{...i,...a,...e.style}},"function"==typeof r?r({icon:n,message:l}):s.createElement(s.Fragment,null,n,l))});Se=s.createElement,ne.p=_e,X=Se,ee=Ee,te=Oe;var Ve=({id:e,className:t,style:a,onHeightUpdate:r,children:i})=>{let n=s.useCallback(t=>{if(t){let s=()=>{let s=t.getBoundingClientRect().height;r(e,s)};s(),new MutationObserver(s).observe(t,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return s.createElement("div",{ref:n,className:t,style:a},i)},Ye=ce`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Ze=({reverseOrder:e,position:t="top-center",toastOptions:a,gutter:r,children:i,toasterId:n,containerStyle:l,containerClassName:o})=>{let{toasts:c,handlers:d}=Me(a,n);return s.createElement("div",{"data-rht-toaster":n||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...l},className:o,onMouseEnter:d.startPause,onMouseLeave:d.endPause},c.map(a=>{let n=a.position||t,l=((e,t)=>{let s=e.includes("top"),a=s?{top:0}:{bottom:0},r=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:he()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(s?1:-1)}px)`,...a,...r}})(n,d.calculateOffset(a,{reverseOrder:e,gutter:r,defaultPosition:t}));return s.createElement(Ve,{id:a.id,key:a.id,onHeightUpdate:d.updateHeight,className:a.visible?Ye:"",style:l},"custom"===a.type?me(a.message,a):i?i(a):s.createElement(We,{toast:a,position:n}))}))},Xe=Ce;const et={};function tt(e,t){let s;try{s=e()}catch(a){return}return{getItem:e=>{var t;const a=e=>null===e?null:JSON.parse(e,void 0),r=null!=(t=s.getItem(e))?t:null;return r instanceof Promise?r.then(a):a(r)},setItem:(e,t)=>s.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>s.removeItem(e)}}const st=e=>t=>{try{const s=e(t);return s instanceof Promise?s:{then:e=>st(e)(s),catch(e){return this}}}catch(Se){return{then(e){return this},catch:t=>st(t)(Se)}}},at=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?("production"!==(et?"production":void 0)&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),((e,t)=>(s,a,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const l=new Set,o=new Set;let c;try{c=i.getStorage()}catch(g){}if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...e)},a,r);const d=st(i.serialize),u=()=>{const e=i.partialize({...a()});let t;const s=d({state:e,version:i.version}).then(e=>c.setItem(i.name,e)).catch(e=>{t=e});if(t)throw t;return s},m=r.setState;r.setState=(e,t)=>{m(e,t),u()};const x=e((...e)=>{s(...e),u()},a,r);let h;const p=()=>{var e;if(!c)return;n=!1,l.forEach(e=>e(a()));const t=(null==(e=i.onRehydrateStorage)?void 0:e.call(i,a()))||void 0;return st(c.getItem.bind(c))(i.name).then(e=>{if(e)return i.deserialize(e)}).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return e.state;if(i.migrate)return i.migrate(e.state,e.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}}).then(e=>{var t;return h=i.merge(e,null!=(t=a())?t:x),s(h,!0),u()}).then(()=>{null==t||t(h,void 0),n=!0,o.forEach(e=>e(h))}).catch(e=>{null==t||t(void 0,e)})};return r.persist={setOptions:e=>{i={...i,...e},e.getStorage&&(c=e.getStorage())},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>p(),hasHydrated:()=>n,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},p(),h||x})(e,t)):((e,t)=>(s,a,r)=>{let i={storage:tt(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},n=!1;const l=new Set,o=new Set;let c=i.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),s(...e)},a,r);const d=()=>{const e=i.partialize({...a()});return c.setItem(i.name,{state:e,version:i.version})},u=r.setState;r.setState=(e,t)=>{u(e,t),d()};const m=e((...e)=>{s(...e),d()},a,r);let x;r.getInitialState=()=>m;const h=()=>{var e,t;if(!c)return;n=!1,l.forEach(e=>{var t;return e(null!=(t=a())?t:m)});const r=(null==(t=i.onRehydrateStorage)?void 0:t.call(i,null!=(e=a())?e:m))||void 0;return st(c.getItem.bind(c))(i.name).then(e=>{if(e){if("number"!=typeof e.version||e.version===i.version)return[!1,e.state];if(i.migrate)return[!0,i.migrate(e.state,e.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;const[r,n]=e;if(x=i.merge(n,null!=(t=a())?t:m),s(x,!0),r)return d()}).then(()=>{null==r||r(x,void 0),x=a(),n=!0,o.forEach(e=>e(x))}).catch(e=>{null==r||r(void 0,e)})};return r.persist={setOptions:e=>{i={...i,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>h(),hasHydrated:()=>n,onHydrate:e=>(l.add(e),()=>{l.delete(e)}),onFinishHydration:e=>(o.add(e),()=>{o.delete(e)})},i.skipHydration||h(),x||m})(e,t);const rt=new class{constructor(){t(this,"api"),this.api=c.create({baseURL:"http://localhost:3001",timeout:1e4,headers:{"Content-Type":"application/json"}}),this.api.interceptors.request.use(e=>{const t=it.getState().token;return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e)),this.api.interceptors.response.use(e=>e,e=>{var t;return 401===(null==(t=e.response)?void 0:t.status)&&(it.getState().clearAuth(),window.location.href="/login"),Promise.reject(e)})}async login(e,t){return(await this.api.post("/api/login",{username:e,password:t})).data}async register(e,t,s){return(await this.api.post("/api/register",{username:e,password:t,email:s})).data}async getUserProfile(){return(await this.api.get("/api/user/profile")).data}async searchUsers(e){return(await this.api.get("/api/users/search",{params:{username:e}})).data}async getFriends(){return(await this.api.get("/api/friends")).data}async sendFriendRequest(e){return(await this.api.post("/api/friend-requests",{receiverId:e})).data}async getFriendRequests(){return(await this.api.get("/api/friend-requests")).data}async handleFriendRequest(e,t){return(await this.api.put(`/api/friend-requests/${e}`,{status:t})).data}async deleteFriend(e){return(await this.api.delete(`/api/friends/${e}`)).data}async createGroup(e,t){return(await this.api.post("/api/groups/create",{name:e,description:t})).data}async getMyGroups(){return(await this.api.get("/api/groups/my")).data}async getGroupDetails(e){return(await this.api.get(`/api/groups/${e}`)).data}async inviteToGroup(e,t){return(await this.api.post(`/api/groups/${e}/invite`,{friendIds:t})).data}async getGroupMessages(e,t=50,s){return(await this.api.get(`/api/groups/${e}/messages`,{params:{limit:t,before:s}})).data}async sendGroupMessage(e,t,s="text"){return(await this.api.post(`/api/groups/${e}/messages`,{content:t,messageType:s})).data}async sendPrivateMessage(e,t,s="text"){return(await this.api.post("/api/private-messages",{receiverId:e,content:t,messageType:s})).data}async getPrivateMessages(e,t=50,s){return(await this.api.get(`/api/private-messages/${e}`,{params:{limit:t,before:s}})).data}async uploadFile(e){return(await this.api.post("/api/upload/file",e,{headers:{"Content-Type":"multipart/form-data"}})).data}async healthCheck(){return(await this.api.get("/health")).data}},it=d()(at((e,t)=>({user:null,token:null,isLoading:!1,isAuthenticated:!1,lastActivity:Date.now(),login:async(t,s)=>{e({isLoading:!0});try{const a=await rt.login(t,s);e({user:a.user,token:a.token,isAuthenticated:!0,isLoading:!1,lastActivity:Date.now()})}catch(a){throw e({isLoading:!1}),new Error(a.message||"登录失败")}},register:async(t,s,a)=>{e({isLoading:!0});try{await rt.register(t,s,a),e({isLoading:!1})}catch(r){throw e({isLoading:!1}),new Error(r.message||"注册失败")}},logout:async()=>{e({user:null,token:null,isAuthenticated:!1})},clearAuth:()=>{e({user:null,token:null,isAuthenticated:!1})},initializeAuth:async()=>{const{token:s,user:a}=t();if(s&&a)try{const t=await rt.getUserProfile();e({isAuthenticated:!0,user:t.user,lastActivity:Date.now()})}catch(r){t().clearAuth()}},refreshToken:async()=>{try{const t=await rt.getUserProfile();return e({user:t.user,lastActivity:Date.now()}),!0}catch(s){return t().clearAuth(),!1}},updateActivity:()=>{e({lastActivity:Date.now()})},checkTokenExpiry:()=>{const{lastActivity:e}=t();return!(Date.now()-e>864e5)||(t().clearAuth(),!1)},updateUser:s=>{const{user:a}=t();a&&e({user:{...a,...s}})}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated,lastActivity:e.lastActivity})})),nt=({size:e="md",className:t=""})=>V.jsx("div",{className:`animate-spin rounded-full border-2 border-gray-300 border-t-blue-600 ${{sm:"h-4 w-4",md:"h-6 w-6",lg:"h-8 w-8"}[e]} ${t}`});const lt=new class{constructor(){t(this,"socket",null),t(this,"isConnected",!1)}connect(e){return new Promise((t,s)=>{var a;if(null==(a=this.socket)?void 0:a.connected)return void t();this.socket=u("http://localhost:3001",{auth:{token:e},transports:["websocket","polling"],timeout:2e4,forceNew:!0}),this.socket.on("connect",()=>{var s;console.log("Socket连接成功"),this.isConnected=!0,null==(s=this.socket)||s.emit("login",{token:e}),t()}),this.socket.on("connect_error",e=>{console.error("Socket连接失败:",e),this.isConnected=!1,s(e)}),this.socket.on("disconnect",e=>{console.log("Socket断开连接:",e),this.isConnected=!1}),this.socket.on("login_success",e=>{console.log("Socket登录成功:",e)}),this.socket.on("login_error",e=>{console.error("Socket登录失败:",e),this.disconnect()})})}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null,this.isConnected=!1)}joinGroup(e){this.socket&&this.socket.emit("join_group",e)}leaveGroup(e){this.socket&&this.socket.emit("leave_group",e)}emitTyping(e,t){this.socket&&this.socket.emit("typing",{chatId:e,isTyping:t})}onUserListUpdate(e){this.socket&&this.socket.on("userList",e)}onGroupMessage(e){this.socket&&this.socket.on("group_message",e)}onPrivateMessage(e){this.socket&&this.socket.on("private_message",e)}onFriendRequest(e){this.socket&&this.socket.on("friend_request",e)}onFriendAccepted(e){this.socket&&this.socket.on("friend_accepted",e)}onGroupInvitation(e){this.socket&&this.socket.on("group_invitation",e)}onFriendOnline(e){this.socket&&this.socket.on("friend_online",e)}onFriendOffline(e){this.socket&&this.socket.on("friend_offline",e)}onTyping(e){this.socket&&this.socket.on("typing",e)}off(e){this.socket&&this.socket.off(e)}get connected(){var e;return this.isConnected&&(null==(e=this.socket)?void 0:e.connected)}get socketInstance(){return this.socket}},ot=d(e=>({currentChat:{id:"",name:"",type:"private"},messages:{},friends:[],groups:[],friendRequests:{received:[],sent:[]},onlineUsers:[],setCurrentChat:t=>e({currentChat:t}),addMessage:(t,s)=>e(e=>({messages:{...e.messages,[t]:[...e.messages[t]||[],s]}})),setMessages:(t,s)=>e(e=>({messages:{...e.messages,[t]:s}})),prependMessages:(t,s)=>e(e=>({messages:{...e.messages,[t]:[...s,...e.messages[t]||[]]}})),setFriends:t=>e({friends:t}),setGroups:t=>e({groups:t}),setFriendRequests:t=>e({friendRequests:t}),setOnlineUsers:t=>e({onlineUsers:t}),updateFriendStatus:(t,s)=>e(e=>({friends:e.friends.map(e=>e.id===t?{...e,status:s,isOnline:"online"===s}:e)})),clearMessages:t=>e(e=>({messages:{...e.messages,[t]:[]}})),markMessagesAsRead:t=>e(e=>({}))})),ct=({className:e=""})=>{const{user:t,updateActivity:a}=it(),[r,i]=s.useState(navigator.onLine),[n,l]=s.useState(null);s.useEffect(()=>{const e=()=>{i(!0),a()},t=()=>{i(!1)},s=()=>{document.hidden||a()};window.addEventListener("online",e),window.addEventListener("offline",t),document.addEventListener("visibilitychange",s);const r=setInterval(()=>{a()},3e5);return()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t),document.removeEventListener("visibilitychange",s),clearInterval(r)}},[a]),s.useEffect(()=>{"offline"===(null==t?void 0:t.status)&&l(new Date)},[null==t?void 0:t.status]);return V.jsxs("div",{className:`flex items-center space-x-1 ${e}`,children:[V.jsxs("div",{className:"flex items-center space-x-1 "+(r?"online"===(null==t?void 0:t.status)?"text-green-500":"text-gray-400":"text-red-500"),children:[r?"online"===(null==t?void 0:t.status)?V.jsx(x,{className:"h-3 w-3"}):V.jsx(h,{className:"h-3 w-3"}):V.jsx(m,{className:"h-3 w-3"}),V.jsx("span",{className:"text-xs font-medium",children:r?"online"===(null==t?void 0:t.status)?"在线":"离开":"离线"})]}),n&&"offline"===(null==t?void 0:t.status)&&V.jsx("span",{className:"text-xs text-gray-400",children:n.toLocaleTimeString()})]})},dt=({onClose:e})=>{var t;const{user:a,updateUser:r}=it(),[i,n]=s.useState({username:(null==a?void 0:a.username)||"",email:(null==a?void 0:a.email)||"",avatar:(null==a?void 0:a.avatar)||""}),[l,o]=s.useState(!1),[c,d]=s.useState(!1),u=e=>{const{name:t,value:s}=e.target;n(e=>({...e,[t]:s}))};return V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[V.jsxs("div",{className:"flex items-center justify-between mb-6",children:[V.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"编辑资料"}),V.jsx("button",{onClick:e,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",title:"关闭","aria-label":"关闭编辑资料",children:V.jsx(p,{className:"h-5 w-5"})})]}),V.jsxs("form",{onSubmit:async t=>{if(t.preventDefault(),i.username.trim())try{o(!0),r(i),Xe.success("资料更新成功"),e()}catch(s){console.error("更新资料失败:",s),Xe.error("更新资料失败: "+(s.message||"未知错误"))}finally{o(!1)}else Xe.error("用户名不能为空")},className:"space-y-4",children:[V.jsxs("div",{className:"flex items-center space-x-4",children:[V.jsxs("div",{className:"relative",children:[V.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold text-xl",children:i.avatar?V.jsx("img",{src:i.avatar,alt:"头像",className:"w-full h-full rounded-full object-cover"}):(null==(t=i.username[0])?void 0:t.toUpperCase())||"U"}),V.jsxs("label",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white rounded-full p-1 cursor-pointer hover:bg-blue-600 transition-colors",children:[V.jsx(g,{className:"h-3 w-3"}),V.jsx("input",{type:"file",accept:"image/*",onChange:async e=>{var t;const s=null==(t=e.target.files)?void 0:t[0];if(s)if(s.type.startsWith("image/"))if(s.size>5242880)Xe.error("图片大小不能超过5MB");else try{d(!0);const e=new FormData;e.append("file",s);const t=await rt.uploadFile(e);n(e=>({...e,avatar:t.filePath})),Xe.success("头像上传成功")}catch(a){console.error("头像上传失败:",a),Xe.error("头像上传失败: "+(a.message||"未知错误"))}finally{d(!1)}else Xe.error("请选择图片文件")},className:"hidden",disabled:c,"aria-label":"上传头像",title:"选择头像文件"})]})]}),V.jsxs("div",{children:[V.jsx("p",{className:"text-sm font-medium text-gray-900",children:"头像"}),V.jsx("p",{className:"text-xs text-gray-500",children:"点击相机图标更换头像"})]})]}),V.jsxs("div",{children:[V.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[V.jsx(f,{className:"h-4 w-4 inline mr-1"}),"用户名"]}),V.jsx("input",{type:"text",name:"username",value:i.username,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-transparent",placeholder:"请输入用户名",required:!0})]}),V.jsxs("div",{children:[V.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[V.jsx(y,{className:"h-4 w-4 inline mr-1"}),"邮箱"]}),V.jsx("input",{type:"email",name:"email",value:i.email,onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-transparent",placeholder:"请输入邮箱"})]}),V.jsxs("div",{className:"flex space-x-3 pt-4",children:[V.jsx("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"取消"}),V.jsx("button",{type:"submit",disabled:l||c,className:"flex-1 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:l?V.jsx(nt,{size:"sm"}):V.jsxs(V.Fragment,{children:[V.jsx(b,{className:"h-4 w-4 mr-1"}),"保存"]})})]})]})]})})},ut=({message:e,isOwn:t,showAvatar:s=!0,prevMessage:a})=>{const r=!a||new Date(e.created_at).getTime()-new Date(a.created_at).getTime()>3e5;return V.jsx("div",{className:`flex ${t?"justify-end":"justify-start"} mb-2`,children:V.jsxs("div",{className:"flex items-end space-x-2 max-w-xs lg:max-w-md "+(t?"flex-row-reverse space-x-reverse":""),children:[!t&&s&&V.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-gray-400 to-gray-600 rounded-full flex items-center justify-center text-white text-xs font-semibold flex-shrink-0",children:e.sender_name[0].toUpperCase()}),V.jsxs("div",{className:"relative "+(t?"ml-12":"mr-12"),children:[!t&&s&&V.jsx("p",{className:"text-xs font-semibold text-gray-600 mb-1 px-1",children:e.sender_name}),V.jsx("div",{className:"px-4 py-2 rounded-2xl "+(t?"bg-blue-500 text-white rounded-br-md":"bg-gray-200 text-gray-900 rounded-bl-md"),children:(()=>{switch(e.message_type){case"text":return V.jsx("div",{className:"whitespace-pre-wrap break-words",children:e.content});case"image":return V.jsxs("div",{className:"relative group",children:[V.jsx("img",{src:e.content,alt:"图片",className:"max-w-xs max-h-64 rounded-lg cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>window.open(e.content,"_blank")}),V.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 rounded-lg flex items-center justify-center",children:V.jsx(w,{className:"h-6 w-6 text-white opacity-0 group-hover:opacity-100 transition-opacity"})})]});case"file":const t=e.content.split("/").pop()||"文件";return V.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[V.jsx("div",{className:"flex-shrink-0",children:V.jsx(v,{className:"h-8 w-8 text-blue-500"})}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t}),V.jsx("p",{className:"text-xs text-gray-500",children:"点击下载"})]}),V.jsx("button",{onClick:()=>window.open(e.content,"_blank"),className:"flex-shrink-0 p-1 text-gray-400 hover:text-gray-600 transition-colors",title:"下载文件",children:V.jsx(j,{className:"h-4 w-4"})})]});default:return V.jsx("div",{children:e.content})}})()}),r&&V.jsx("p",{className:"text-xs text-gray-500 mt-1 px-1 "+(t?"text-right":"text-left"),children:(e=>{const t=new Date(e);return((new Date).getTime()-t.getTime())/36e5<24?t.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):t.toLocaleDateString([],{month:"short",day:"numeric"})})(e.created_at)})]})]})})},mt=({onSendMessage:e,onFileUpload:t,isLoading:a=!1,disabled:r=!1,placeholder:i="输入消息..."})=>{const[n,l]=s.useState(""),[o,c]=s.useState(!1),[d,u]=s.useState(!1),m=s.useRef(null),x=s.useRef(null);s.useEffect(()=>{m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},[n]);const h=()=>{!n.trim()||a||r||(e(n.trim()),l(""))};return V.jsxs("div",{className:"relative bg-white border-t border-gray-200 p-4",children:[d&&V.jsxs("div",{className:"absolute bottom-full left-4 mb-2 bg-white border border-gray-200 rounded-lg shadow-lg p-2 z-20",children:[V.jsxs("button",{onClick:()=>{var e;return null==(e=x.current)?void 0:e.click()},className:"flex items-center space-x-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[V.jsx(N,{className:"h-4 w-4"}),V.jsx("span",{children:"图片"})]}),V.jsxs("button",{onClick:()=>{var e;return null==(e=x.current)?void 0:e.click()},className:"flex items-center space-x-2 w-full px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded",children:[V.jsx(v,{className:"h-4 w-4"}),V.jsx("span",{children:"文件"})]})]}),o&&V.jsx("div",{className:"absolute bottom-full right-4 mb-2 p-3 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:V.jsx("div",{className:"grid grid-cols-8 gap-1 max-h-32 overflow-y-auto",children:["😀","😃","😄","😁","😆","😅","😂","🤣","😊","😇","🙂","🙃","😉","😌","😍","🥰","😘","😗","😙","😚","😋","😛","😝","😜","🤪","🤨","🧐","🤓","😎","🤩","🥳","😏"].map(e=>V.jsx("button",{onClick:()=>(e=>{l(t=>t+e),c(!1)})(e),className:"p-2 hover:bg-gray-100 rounded text-lg",type:"button",children:e},e))})}),V.jsxs("div",{className:"flex items-end space-x-2",children:[V.jsx("button",{onClick:()=>u(!d),disabled:r,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"发送附件",children:V.jsx(k,{className:"h-5 w-5"})}),V.jsx("button",{onClick:()=>c(!o),disabled:r,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"选择表情",children:V.jsx(C,{className:"h-5 w-5"})}),V.jsx("div",{className:"flex-1 relative",children:V.jsx("textarea",{ref:m,value:n,onChange:e=>l(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),h())},placeholder:i,disabled:r,className:"w-full resize-none border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-200 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed max-h-32 min-h-[40px]",rows:1})}),V.jsx("button",{onClick:h,disabled:!n.trim()||a||r,className:"p-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:"发送消息",children:a?V.jsx(nt,{size:"sm"}):V.jsx(S,{className:"h-5 w-5"})})]}),V.jsx("input",{ref:x,type:"file",onChange:e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];a&&(t(a),u(!1))},className:"hidden",accept:"image/*,.pdf,.doc,.docx,.txt,.zip,.rar","aria-label":"选择文件上传"})]})},xt=()=>{const{currentChat:e,messages:t}=ot(),{user:a}=it(),[r,i]=s.useState(!1),[n,l]=s.useState(!1),o=s.useRef(null);s.useRef();s.useEffect(()=>{var e;null==(e=o.current)||e.scrollIntoView({behavior:"smooth"})},[t]);if(!e.id)return V.jsx("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:V.jsxs("div",{className:"text-center",children:[V.jsx("div",{className:"w-24 h-24 mx-auto mb-4 bg-gray-200 rounded-full flex items-center justify-center",children:V.jsx(S,{className:"h-12 w-12 text-gray-400"})}),V.jsx("h3",{className:"text-xl font-semibold text-gray-600 mb-2",children:"欢迎使用IM聊天"}),V.jsx("p",{className:"text-gray-500",children:"选择一个聊天开始对话"})]})});const c=t[e.id]||[];return V.jsxs("div",{className:"flex-1 flex flex-col bg-white",children:[V.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-white",children:[V.jsxs("div",{className:"flex items-center space-x-3",children:[V.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:e.name[0].toUpperCase()}),V.jsxs("div",{children:[V.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),V.jsx("p",{className:"text-sm text-gray-500",children:"group"===e.type?"群聊":"私聊"})]})]}),V.jsxs("div",{className:"flex items-center space-x-2",children:[V.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"语音通话",children:V.jsx(_,{className:"h-5 w-5"})}),V.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"视频通话",children:V.jsx(E,{className:"h-5 w-5"})}),V.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"更多",children:V.jsx(O,{className:"h-5 w-5"})})]})]}),V.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[0===c.length?V.jsx("div",{className:"text-center text-gray-500 py-8",children:V.jsx("p",{children:"还没有消息，开始对话吧！"})}):c.map((e,t)=>{const s=t>0?c[t-1]:void 0,r=e.sender_id===(null==a?void 0:a.id),i=!s||s.sender_id!==e.sender_id;return V.jsx(ut,{message:e,isOwn:r,showAvatar:i,prevMessage:s},e.id)}),r&&V.jsx("div",{className:"flex justify-center",children:V.jsx(nt,{size:"sm"})}),V.jsx("div",{ref:o})]}),V.jsx(mt,{onSendMessage:async t=>{if(t.trim()&&e.id&&a){i(!0);try{"group"===e.type?await rt.sendGroupMessage(e.id,t):await rt.sendPrivateMessage(e.id,t)}catch(s){console.error("发送消息失败:",s),Xe.error("发送消息失败: "+(s.message||"未知错误"))}finally{i(!1)}}},onFileUpload:async t=>{if(t.size>52428800)Xe.error("文件大小不能超过50MB");else try{i(!0);const s=new FormData;s.append("file",t);const a=await rt.uploadFile(s);"group"===e.type?await rt.sendGroupMessage(e.id,a.filePath,"file"):await rt.sendPrivateMessage(e.id,a.filePath,"file"),Xe.success("文件发送成功")}catch(s){console.error("文件上传失败:",s),Xe.error("文件上传失败: "+(s.message||"未知错误"))}finally{i(!1)}},isLoading:r,disabled:!e.id,placeholder:"输入消息..."})]})},ht=({searchQuery:e})=>{const t=[{id:"1",username:"张三",status:"online"},{id:"2",username:"李四",status:"offline"},{id:"3",username:"王五",status:"online"}].filter(t=>t.username.toLowerCase().includes(e.toLowerCase()));return V.jsxs("div",{className:"p-4",children:[V.jsxs("div",{className:"flex items-center justify-between mb-4",children:[V.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"好友列表"}),V.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"添加好友",children:V.jsx(M,{className:"h-5 w-5"})})]}),0===t.length?V.jsxs("div",{className:"text-center text-gray-500 py-8",children:[V.jsx(z,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),V.jsx("p",{children:"没有找到好友"})]}):V.jsx("div",{className:"space-y-2",children:t.map(e=>V.jsxs("div",{className:"flex items-center p-3 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors",children:[V.jsxs("div",{className:"relative",children:[V.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:e.username[0]}),V.jsx("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 rounded-full border-2 border-white "+("online"===e.status?"bg-green-500":"bg-gray-400")})]}),V.jsxs("div",{className:"ml-3 flex-1",children:[V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("p",{className:"font-medium text-gray-900",children:e.username}),"agent"===e.role&&V.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"经纪人"}),"admin"===e.role&&V.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 text-xs rounded-full font-medium",children:"管理员"})]}),V.jsx("p",{className:"text-sm text-gray-500",children:"online"===e.status?"在线":"离线"})]})]},e.id))})]})},pt=({searchQuery:e})=>{const t=[{id:"1",name:"工作群",members:["张三","李四","王五"]},{id:"2",name:"朋友群",members:["张三","李四"]},{id:"3",name:"家庭群",members:["张三","王五"]}].filter(t=>t.name.toLowerCase().includes(e.toLowerCase()));return V.jsxs("div",{className:"p-4",children:[V.jsxs("div",{className:"flex items-center justify-between mb-4",children:[V.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"群组列表"}),V.jsx("button",{className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg transition-colors",title:"创建群组",children:V.jsx(P,{className:"h-5 w-5"})})]}),0===t.length?V.jsxs("div",{className:"text-center text-gray-500 py-8",children:[V.jsx($,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),V.jsx("p",{children:"没有找到群组"})]}):V.jsx("div",{className:"space-y-2",children:t.map(e=>V.jsxs("div",{className:"flex items-center p-3 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors",children:[V.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white font-semibold",children:e.name[0]}),V.jsxs("div",{className:"ml-3 flex-1",children:[V.jsx("p",{className:"font-medium text-gray-900",children:e.name}),V.jsxs("p",{className:"text-sm text-gray-500",children:[e.members.length," 名成员"]})]})]},e.id))})]})},gt=()=>{const{currentChat:e,setCurrentChat:t,friends:a,groups:r,setMessages:i}=ot(),{user:n}=it(),[l,o]=s.useState([]),[c,d]=s.useState(!0);s.useEffect(()=>{u()},[a,r]);const u=async()=>{try{d(!0);const e=[];a.forEach(t=>{e.push({id:t.id,name:t.username,type:"private",unreadCount:0,isOnline:t.isOnline||!1,avatar:t.avatar})}),r.forEach(t=>{e.push({id:t.id,name:t.name,type:"group",unreadCount:0,avatar:t.avatar})}),e.sort((e,t)=>e.lastMessageTime&&t.lastMessageTime?new Date(t.lastMessageTime).getTime()-new Date(e.lastMessageTime).getTime():0),o(e)}catch(e){console.error("加载最近聊天失败:",e),Xe.error("加载聊天列表失败")}finally{d(!1)}};return c?V.jsx("div",{className:"p-4",children:V.jsx("div",{className:"animate-pulse space-y-3",children:[1,2,3].map(e=>V.jsxs("div",{className:"flex items-center space-x-3",children:[V.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),V.jsxs("div",{className:"flex-1",children:[V.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-1"}),V.jsx("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]},e))})}):0===l.length?V.jsxs("div",{className:"p-4 text-center text-gray-500",children:[V.jsx($,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),V.jsx("p",{children:"还没有聊天记录"}),V.jsx("p",{className:"text-sm",children:"添加好友或创建群组开始聊天"})]}):V.jsxs("div",{className:"p-2",children:[V.jsx("h3",{className:"text-sm font-semibold text-gray-500 uppercase tracking-wider mb-3 px-2",children:"最近聊天"}),V.jsx("div",{className:"space-y-1",children:l.map(s=>V.jsxs("button",{onClick:()=>(async e=>{try{if(t({id:e.id,name:e.name,type:e.type,avatar:e.avatar}),"private"===e.type){const t=await rt.getPrivateMessages(e.id);i(e.id,t.messages||[])}else{const t=await rt.getGroupMessages(e.id);i(e.id,t.messages||[])}}catch(s){console.error("加载聊天失败:",s),Xe.error("加载聊天失败")}})(s),className:"w-full flex items-center space-x-3 p-3 rounded-lg transition-colors "+(e.id===s.id&&e.type===s.type?"bg-blue-50 border border-blue-200":"hover:bg-gray-50"),children:[V.jsxs("div",{className:"relative",children:[V.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-400 to-blue-600 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:s.avatar?V.jsx("img",{src:s.avatar,alt:s.name,className:"w-full h-full rounded-full object-cover"}):s.name[0].toUpperCase()}),"private"===s.type&&s.isOnline&&V.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 border-2 border-white rounded-full"})]}),V.jsxs("div",{className:"flex-1 min-w-0",children:[V.jsxs("div",{className:"flex items-center justify-between",children:[V.jsx("h4",{className:"text-sm font-semibold text-gray-900 truncate",children:s.name}),s.unreadCount>0&&V.jsx("span",{className:"bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:s.unreadCount})]}),V.jsxs("div",{className:"flex items-center justify-between mt-1",children:[V.jsx("p",{className:"text-xs text-gray-500 truncate",children:s.lastMessage||"还没有消息"}),s.lastMessageTime&&V.jsx("span",{className:"text-xs text-gray-400",children:new Date(s.lastMessageTime).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]}),V.jsx("div",{className:"flex-shrink-0",children:"group"===s.type?V.jsx(z,{className:"h-4 w-4 text-gray-400"}):V.jsx(f,{className:"h-4 w-4 text-gray-400"})})]},`${s.type}_${s.id}`))})]})},ft=({isOpen:e,onClose:t,children:s,title:a})=>e?V.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:V.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[a&&V.jsxs("div",{className:"flex items-center justify-between mb-4",children:[V.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:a}),V.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",title:"关闭",children:V.jsx(p,{className:"h-5 w-5"})})]}),s]})}):null,yt=({isOpen:e,onClose:t})=>{const[a,r]=s.useState(""),[i,n]=s.useState([]),[l,o]=s.useState(!1),c=async()=>{if(a.trim())try{o(!0);const e=await rt.searchUsers(a);n(e.users||[])}catch(e){Xe.error("搜索失败: "+(e.message||"未知错误"))}finally{o(!1)}};return V.jsx(ft,{isOpen:e,onClose:t,title:"添加好友",children:V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{className:"flex space-x-2",children:[V.jsxs("div",{className:"flex-1 relative",children:[V.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),V.jsx("input",{type:"text",placeholder:"搜索用户名...",value:a,onChange:e=>r(e.target.value),onKeyPress:e=>"Enter"===e.key&&c(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),V.jsx("button",{onClick:c,disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:l?"搜索中...":"搜索"})]}),V.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:0===i.length?V.jsx("p",{className:"text-gray-500 text-center py-4",children:"暂无搜索结果"}):i.map(e=>V.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[V.jsxs("div",{className:"flex items-center",children:[V.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-sm",children:e.username[0]}),V.jsxs("div",{className:"ml-3",children:[V.jsxs("div",{className:"flex items-center gap-2",children:[V.jsx("p",{className:"font-medium text-gray-900",children:e.username}),"agent"===e.role&&V.jsx("span",{className:"px-2 py-0.5 bg-blue-100 text-blue-800 text-xs rounded-full font-medium",children:"经纪人"}),"admin"===e.role&&V.jsx("span",{className:"px-2 py-0.5 bg-red-100 text-red-800 text-xs rounded-full font-medium",children:"管理员"})]}),e.email&&V.jsx("p",{className:"text-sm text-gray-500",children:e.email})]})]}),V.jsx("button",{onClick:()=>(async e=>{try{await rt.sendFriendRequest(e),Xe.success("好友请求已发送")}catch(t){Xe.error("发送失败: "+(t.message||"未知错误"))}})(e.id),className:"px-3 py-1 bg-blue-500 text-white text-sm rounded hover:bg-blue-600",title:"发送好友请求",children:V.jsx(M,{className:"h-4 w-4"})})]},e.id))})]})})},bt=({isOpen:e,onClose:t})=>{const[a,r]=s.useState(""),[i,n]=s.useState(""),[l,o]=s.useState(!1);return V.jsx(ft,{isOpen:e,onClose:t,title:"创建群组",children:V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{htmlFor:"groupName",className:"block text-sm font-medium text-gray-700 mb-1",children:"群组名称 *"}),V.jsx("input",{id:"groupName",type:"text",value:a,onChange:e=>r(e.target.value),placeholder:"请输入群组名称",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"groupDescription",className:"block text-sm font-medium text-gray-700 mb-1",children:"群组描述"}),V.jsx("textarea",{id:"groupDescription",value:i,onChange:e=>n(e.target.value),placeholder:"请输入群组描述（可选）",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),V.jsxs("div",{className:"flex justify-end space-x-3",children:[V.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"取消"}),V.jsx("button",{onClick:async()=>{if(a.trim())try{o(!0),await rt.createGroup(a,i),Xe.success("群组创建成功"),r(""),n(""),t()}catch(e){Xe.error("创建失败: "+(e.message||"未知错误"))}finally{o(!1)}else Xe.error("请输入群组名称")},disabled:l,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50",children:l?"创建中...":"创建群组"})]})]})})},vt=({isOpen:e,onClose:t})=>{const s=[{id:"1",sender_username:"张三",created_at:"2024-01-01"},{id:"2",sender_username:"李四",created_at:"2024-01-02"}];return V.jsx(ft,{isOpen:e,onClose:t,title:"好友请求",children:V.jsx("div",{className:"space-y-3",children:0===s.length?V.jsx("p",{className:"text-gray-500 text-center py-4",children:"暂无好友请求"}):s.map(e=>V.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[V.jsxs("div",{children:[V.jsx("p",{className:"font-medium text-gray-900",children:e.sender_username}),V.jsx("p",{className:"text-sm text-gray-500",children:e.created_at})]}),V.jsxs("div",{className:"flex space-x-2",children:[V.jsx("button",{onClick:()=>{return t=e.id,void console.log("Accept friend request:",t);var t},className:"px-3 py-1 bg-green-500 text-white text-sm rounded hover:bg-green-600",children:"接受"}),V.jsx("button",{onClick:()=>{return t=e.id,void console.log("Reject friend request:",t);var t},className:"px-3 py-1 bg-red-500 text-white text-sm rounded hover:bg-red-600",children:"拒绝"})]})]},e.id))})})},jt=({isOpen:e,onClose:t,user:s})=>s?V.jsx(ft,{isOpen:e,onClose:t,title:"个人资料",children:V.jsxs("div",{className:"space-y-6",children:[V.jsxs("div",{className:"text-center",children:[V.jsx("div",{className:"w-20 h-20 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold text-2xl mx-auto mb-4",children:s.username[0].toUpperCase()}),V.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:s.username})]}),V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{className:"flex items-center",children:[V.jsx(f,{className:"h-5 w-5 text-gray-400 mr-3"}),V.jsxs("div",{children:[V.jsx("p",{className:"text-sm text-gray-500",children:"用户名"}),V.jsx("p",{className:"font-medium text-gray-900",children:s.username})]})]}),s.email&&V.jsxs("div",{className:"flex items-center",children:[V.jsx(y,{className:"h-5 w-5 text-gray-400 mr-3"}),V.jsxs("div",{children:[V.jsx("p",{className:"text-sm text-gray-500",children:"邮箱"}),V.jsx("p",{className:"font-medium text-gray-900",children:s.email})]})]}),V.jsxs("div",{className:"flex items-center",children:[V.jsx(L,{className:"h-5 w-5 text-gray-400 mr-3"}),V.jsxs("div",{children:[V.jsx("p",{className:"text-sm text-gray-500",children:"状态"}),V.jsxs("p",{className:"font-medium text-gray-900",children:[V.jsx("span",{className:"inline-block w-2 h-2 rounded-full mr-2 "+("online"===s.status?"bg-green-500":"bg-gray-400")}),"online"===s.status?"在线":"离线"]})]})]})]}),V.jsx("div",{className:"flex justify-end",children:V.jsx("button",{onClick:t,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"关闭"})})]})}):null,wt=()=>{const{user:e,logout:t}=it(),{currentChat:a,setFriends:r,setGroups:i,setFriendRequests:n,setOnlineUsers:l,addMessage:o}=ot(),[c,d]=s.useState("chats"),[u,m]=s.useState(!1),[x,h]=s.useState(!1),[p,g]=s.useState(!1),[f,y]=s.useState(!1),[b,v]=s.useState(!1),[j,w]=s.useState(!0),[N,k]=s.useState("");s.useEffect(()=>{if(e)return C(),S(),()=>{lt.disconnect()}},[e]);const C=async()=>{try{w(!0);const[t,s,a]=await Promise.all([rt.getFriends(),rt.getMyGroups(),rt.getFriendRequests()]);r(t.friends||[]),i(s.groups||[]),n(a||{received:[],sent:[]}),(null==e?void 0:e.token)&&await lt.connect(e.token)}catch(t){console.error("加载数据失败:",t),Xe.error("加载数据失败: "+(t.message||"未知错误"))}finally{w(!1)}},S=()=>{lt.onUserListUpdate(e=>{l(e)}),lt.onGroupMessage(e=>{o(e.group_id,e),"group"===a.type&&a.id===e.group_id||Xe.success(`${e.sender_name}: ${e.content}`,{duration:3e3})}),lt.onPrivateMessage(e=>{const t=`private_${e.sender_id}`;o(t,e),"private"===a.type&&a.id===e.sender_id||Xe.success(`${e.sender_name}: ${e.content}`,{duration:3e3})}),lt.onFriendRequest(e=>{Xe.success(`${e.sender_username} 发送了好友请求`,{duration:5e3}),C()}),lt.onGroupInvitation(e=>{Xe.success(`${e.inviter_name} 邀请您加入群组 ${e.group_name}`,{duration:5e3}),C()})},_=[{key:"chats",icon:$,label:"聊天",badge:0},{key:"friends",icon:z,label:"好友",badge:0},{key:"groups",icon:$,label:"群组",badge:0}];return e?V.jsxs("div",{className:"h-screen bg-gray-50 flex",children:[V.jsxs("div",{className:"w-16 bg-gradient-to-b from-blue-600 to-blue-700 flex flex-col items-center py-4 shadow-lg",children:[V.jsxs("div",{className:"mb-8",children:[V.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center text-blue-600 font-semibold cursor-pointer hover:shadow-md transition-shadow",onClick:()=>y(!0),children:e.avatar?V.jsx("img",{src:e.avatar,alt:e.username,className:"w-full h-full rounded-full object-cover"}):e.username[0].toUpperCase()}),V.jsx(ct,{className:"mt-2"})]}),V.jsx("div",{className:"space-y-4 flex-1",children:_.map(e=>{const t=e.icon;return V.jsxs("button",{onClick:()=>d(e.key),className:"relative w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 "+(c===e.key?"bg-white text-blue-600 shadow-md":"text-white hover:text-blue-100 hover:bg-blue-500"),title:e.label,children:[V.jsx(t,{className:"h-5 w-5"}),e.badge>0&&V.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center",children:e.badge})]},e.key)})}),V.jsxs("div",{className:"space-y-4",children:[V.jsx("button",{onClick:()=>m(!0),className:"w-10 h-10 rounded-lg flex items-center justify-center text-white hover:text-blue-100 hover:bg-blue-500 transition-all duration-200",title:"好友请求",children:V.jsx(F,{className:"h-5 w-5"})}),V.jsx("button",{onClick:()=>h(!0),className:"w-10 h-10 rounded-lg flex items-center justify-center text-white hover:text-blue-100 hover:bg-blue-500 transition-all duration-200",title:"添加好友",children:V.jsx(M,{className:"h-5 w-5"})}),V.jsx("button",{onClick:()=>d("settings"),className:"w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-200 "+("settings"===c?"bg-white text-blue-600 shadow-md":"text-white hover:text-blue-100 hover:bg-blue-500"),title:"设置",children:V.jsx(I,{className:"h-5 w-5"})}),V.jsx("button",{onClick:async()=>{try{lt.disconnect(),await t(),Xe.success("已退出登录")}catch(e){console.error("退出登录失败:",e),Xe.error("退出登录失败")}},className:"w-10 h-10 rounded-lg flex items-center justify-center text-white hover:text-red-200 hover:bg-red-500 transition-all duration-200",title:"退出登录",children:V.jsx(D,{className:"h-5 w-5"})})]})]}),V.jsxs("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[V.jsx("div",{className:"p-4 border-b border-gray-200",children:V.jsxs("div",{className:"relative",children:[V.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),V.jsx("input",{type:"text",placeholder:"搜索...",value:N,onChange:e=>k(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),V.jsx("div",{className:"flex-1 overflow-y-auto",children:(()=>{if(j)return V.jsx("div",{className:"flex items-center justify-center h-64",children:V.jsx(nt,{})});switch(c){case"friends":return V.jsx(ht,{searchQuery:N});case"groups":return V.jsx(pt,{searchQuery:N});default:return V.jsx(gt,{})}})()})]}),V.jsx("div",{className:"flex-1 flex flex-col",children:V.jsx(xt,{})}),V.jsx(vt,{isOpen:u,onClose:()=>m(!1)}),V.jsx(yt,{isOpen:x,onClose:()=>h(!1)}),V.jsx(bt,{isOpen:p,onClose:()=>g(!1)}),V.jsx(jt,{isOpen:f,onClose:()=>y(!1),user:e,onEdit:()=>{y(!1),v(!0)}}),V.jsx(dt,{isOpen:b,onClose:()=>v(!1)})]}):null},Nt=()=>{const{login:e,isLoading:t}=it(),[a,r]=s.useState({username:"",password:""}),[i,n]=s.useState(!1),l=e=>{r({...a,[e.target.name]:e.target.value})};return V.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:V.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[V.jsxs("div",{className:"text-center",children:[V.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"登录到IM系统"}),V.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"欢迎回来，请登录您的账户"})]}),V.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),a.username&&a.password)try{await e(a.username,a.password),Xe.success("登录成功")}catch(s){Xe.error(s.message||"登录失败")}else Xe.error("请填写所有字段")},children:[V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"用户名"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(f,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:a.username,onChange:l,className:"appearance-none rounded-lg relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请输入用户名"})]})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(T,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"password",name:"password",type:i?"text":"password",required:!0,value:a.password,onChange:l,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请输入密码"}),V.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:V.jsx("button",{type:"button",onClick:()=>n(!i),className:"text-gray-400 hover:text-gray-600",children:i?V.jsx(R,{className:"h-5 w-5"}):V.jsx(w,{className:"h-5 w-5"})})})]})]})]}),V.jsx("div",{children:V.jsx("button",{type:"submit",disabled:t,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"登录中...":"登录"})}),V.jsx("div",{className:"text-center",children:V.jsxs("p",{className:"text-sm text-gray-600",children:["还没有账户？"," ",V.jsx("a",{href:"/register",className:"font-medium text-blue-600 hover:text-blue-500",children:"立即注册"})]})})]})]})})},kt=()=>{const{register:e,isLoading:t}=it(),[a,r]=s.useState({username:"",email:"",password:"",confirmPassword:""}),[i,n]=s.useState(!1),[l,o]=s.useState(!1),c=e=>{r({...a,[e.target.name]:e.target.value})};return V.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:V.jsxs("div",{className:"max-w-md w-full space-y-8 p-8",children:[V.jsxs("div",{className:"text-center",children:[V.jsx("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:"注册IM账户"}),V.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"创建您的账户，开始使用IM系统"})]}),V.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async t=>{if(t.preventDefault(),a.username&&a.password&&a.confirmPassword)if(a.password===a.confirmPassword)if(a.password.length<6)Xe.error("密码长度至少6位");else try{await e(a.username,a.password,a.email),Xe.success("注册成功，请登录"),window.location.href="/login"}catch(s){Xe.error(s.message||"注册失败")}else Xe.error("两次输入的密码不一致");else Xe.error("请填写所有必填字段")},children:[V.jsxs("div",{className:"space-y-4",children:[V.jsxs("div",{children:[V.jsx("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"用户名 *"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(f,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"username",name:"username",type:"text",required:!0,value:a.username,onChange:c,className:"appearance-none rounded-lg relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请输入用户名"})]})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"邮箱"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(y,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"email",name:"email",type:"email",value:a.email,onChange:c,className:"appearance-none rounded-lg relative block w-full pl-10 pr-3 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请输入邮箱（可选）"})]})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码 *"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(T,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"password",name:"password",type:i?"text":"password",required:!0,value:a.password,onChange:c,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请输入密码（至少6位）"}),V.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:V.jsx("button",{type:"button",onClick:()=>n(!i),className:"text-gray-400 hover:text-gray-600",children:i?V.jsx(R,{className:"h-5 w-5"}):V.jsx(w,{className:"h-5 w-5"})})})]})]}),V.jsxs("div",{children:[V.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"确认密码 *"}),V.jsxs("div",{className:"mt-1 relative",children:[V.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:V.jsx(T,{className:"h-5 w-5 text-gray-400"})}),V.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:l?"text":"password",required:!0,value:a.confirmPassword,onChange:c,className:"appearance-none rounded-lg relative block w-full pl-10 pr-10 py-3 border border-gray-300 placeholder-gray-500 text-gray-900 focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"请再次输入密码"}),V.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:V.jsx("button",{type:"button",onClick:()=>o(!l),className:"text-gray-400 hover:text-gray-600",children:l?V.jsx(R,{className:"h-5 w-5"}):V.jsx(w,{className:"h-5 w-5"})})})]})]})]}),V.jsx("div",{children:V.jsx("button",{type:"submit",disabled:t,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:t?"注册中...":"注册"})}),V.jsx("div",{className:"text-center",children:V.jsxs("p",{className:"text-sm text-gray-600",children:["已有账户？"," ",V.jsx("a",{href:"/login",className:"font-medium text-blue-600 hover:text-blue-500",children:"立即登录"})]})})]})]})})};function Ct(){const{user:e,isLoading:t,initializeAuth:a}=it();return s.useEffect(()=>{a()},[a]),t?V.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100",children:V.jsx(nt,{size:"lg"})}):V.jsx(i,{children:V.jsxs("div",{className:"App",children:[V.jsx(Ze,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#4ade80",secondary:"#fff"}},error:{duration:5e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}}),V.jsxs(n,{children:[V.jsx(l,{path:"/login",element:e?V.jsx(o,{to:"/chat",replace:!0}):V.jsx(Nt,{})}),V.jsx(l,{path:"/register",element:e?V.jsx(o,{to:"/chat",replace:!0}):V.jsx(kt,{})}),V.jsx(l,{path:"/chat",element:e?V.jsx(wt,{}):V.jsx(o,{to:"/login",replace:!0})}),V.jsx(l,{path:"/",element:V.jsx(o,{to:e?"/chat":"/login",replace:!0})})]})]})})}Y.createRoot(document.getElementById("root")).render(V.jsx(r.StrictMode,{children:V.jsx(Ct,{})}));
